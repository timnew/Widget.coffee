(function(){var t,n,e,i=[].slice;if(null==this.Widget){if(null==this.console&&(this.console={warn:function(){},error:function(){}}),("undefined"==typeof n||null===n)&&(n=this),t=this.jQuery,null==t)return void console.error("jQuery is not loaded");this.Widget=function(){function n(t){this.element=t,this.element.data("widget",this)}return n.prototype.bindDom=function(){},n.prototype.enhancePage=function(){},n.prototype.initialize=function(){},n.prototype.findWidgets=function(n,e){var i,a,r,d,o;for(d=this.element[n].call(this.element,e),o=[],a=0,r=d.length;r>a;a++)i=d[a],o.push(t(i).data("widget"));return o},n.prototype.findWidget=function(t,n){return this.element[t].call(this.element,n).data("widget")},n.prototype.findSubWidget=function(t){return null==t&&(t="[data-widget]:first"),this.findWidget("find",t)},n.prototype.findSubWidgets=function(t){return null==t&&(t="[data-widget]"),this.findWidgets("find",t)},n.prototype.findParentWidget=function(t){return null==t&&(t="[data-widget]:first"),this.findWidget("parents",t)},n.prototype.findParentWidgets=function(t){return null==t&&(t="[data-widget]"),this.findWidgets("parents",t)},n.prototype.findSubWidgetByType=function(t){return this.findWidget("find","[data-widget='"+t+"']:first")},n.prototype.findSubWidgetsByType=function(t){return this.findWidgets("find","[data-widget='"+t+"']")},n.prototype.findParentWidgetByType=function(t){return this.findWidget("parents","[data-widget='"+t+"']:first")},n.prototype.findParentWidgetsByType=function(t){return this.findWidgets("parents","[data-widget='"+t+"']")},n.prototype.bindWidgetParts=function(n,e,i){var a,r,d,o,l,u;for(null==n&&(n=this),null==e&&(e="[data-widget-part]"),null==i&&(i="data-widget-part"),u=this.element.find(e),o=0,l=u.length;l>o;o++)d=u[o],a=t(d),a.parents("[data-widget]:first")[0]===this.element[0]&&(r=a.attr(i),n[r]=a.is("[data-widget]")?a.data("widget"):a)},n.prototype.bindActionHandlers=function(n,e){var i,a,r,d,o,l;for(null==n&&(n="[data-action-handler]"),null==e&&(e=this),l=this.element.find(n),d=0,o=l.length;o>d;d++)a=l[d],i=t(a),i.parents("[data-widget]:first")[0]===this.element[0]&&(r=i.data("actionHandler"),null!=e[r]?i.on("click",function(){return function(n){return r=t(n.currentTarget).data("actionHandler"),n.stopPropagation(),e[r].call(e,n)}}(this)):console.warn('Action handler "'+r+'" doesn\'t exist in widget "'+this.constructor.name+'"'))},n}(),t.extend(Widget,{extend:function(){var n;return n=1<=arguments.length?i.call(arguments,0):[],n.unshift(this),t.extend.apply(t,n)},include:function(){var n;return n=1<=arguments.length?i.call(arguments,0):[],n.unshift(this.prototype),t.extend.apply(t,n)}}),Widget.extend({register:function(t,n){var e;return null==n&&(n=null),n||(n=null!=(e=t.prototype.widgetType)?e:t.name),this.namespace[n]=t,this},find:function(e,i){var a,r,d,o;if(null==i&&(i=!0),"string"==typeof e)d=e.split(".");else{if(!t.isArray(e))return console.error("Invalid Widget Type:",e),null;d=e}return a=d.shift(),r=i?null!=(o=this.namespace[a])?o:n[a]:this.namespace[a],0===d.length?r:null==r?null:r.find(d,!1)},createNamespace:function(t){return this.namespace=[],this.namespace.name=t,this},findInNamespaces:function(n,e){var i,a,r,d,o,l,u,s;if("@"===n[0]?(a=!0,n=n.slice(1)):a=!1,o=Widget.find(n),null!=o)return o;if(!a)return null;for(r=Widget.namespace.name,s=e.parents("[data-widget]"),l=0,u=s.length;u>l;l++)if(d=s[l],i=t(d).data("widget").constructor,r!==i.namespace.name&&(o=i.find(n,!1),null!=o))return o}}),e=function(n){return null==n?n=t("body"):n instanceof String&&(n=t(n)),n instanceof jQuery||console.error("ERROR: Unknown Scope",n),n},Widget.extend({activateOnReady:function(){return t(function(){return Widget.activateWidgets()})},onActivating:function(t,n){return null==t&&(t=null),t instanceof Function&&(n=t,t=null),t=e(t),t.on("widget.activating",n)},onActivated:function(t,n){return null==t&&(t=null),t instanceof Function&&(n=t,t=null),t=e(t),t.on("widget.activated",n)},activateWidgets:function(n){var i,a,r,d,o,l,u,s;for(null==n&&(n=null),n=e(n),n.trigger("widget.activating"),a=[],n.find("[data-widget]").each(function(){var n,e,i;return n=t(this),i=n.data("widget"),null==i?void console.error("ERROR: Widget name is empty",n):"string"!=typeof i?void console.warn("WARNING: Widget is initialized",n):(e=Widget.findInNamespaces(i,n),e?a.push(new e(n)):console.error("ERROR: Unknown widget "+i,n))}),r=0,l=a.length;l>r;r++)i=a[r],i.bindDom();for(d=0,u=a.length;u>d;d++)i=a[d],i.enhancePage();for(o=0,s=a.length;s>o;o++)i=a[o],i.initialize();return n.trigger("widget.activated",a)},activateWidget:function(n){var e,i,a,r;return e=t(n),r=e.data("widget"),null==r?void console.error("ERROR: Widget name is empty",e):"string"!=typeof r?void console.warn("WARNING: Widget is initialized",e):(a=Widget.findInNamespaces(r,e),a?i=new a(e):console.error("ERROR: Unknown widget "+r,e),i.bindDom(),i.enhancePage(),i.initialize(),e.trigger("widget.activated",[i]),i)}}),Widget.extend({findWidget:function(n){return null==n&&(n="[data-widget]"),t(n).data("widget")},findWidgets:function(n){var e,i,a,r,d;for(null==n&&(n="[data-widget]"),r=t(n),d=[],i=0,a=r.length;a>i;i++)e=r[i],d.push(t(e).data("widget"));return d},findWidgetByType:function(n){return t("[data-widget='"+n+"']").data("widget")},findWidgetsByType:function(n){var e,i,a,r,d;for(r=t("[data-widget='"+n+"']"),d=[],i=0,a=r.length;a>i;i++)e=r[i],d.push(t(e).data("widget"));return d}}),Widget.createNamespace("").activateOnReady()}}).call(this);